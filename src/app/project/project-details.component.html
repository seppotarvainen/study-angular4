<div>
  <div *ngIf="isEditMode; else project_view">
    <ng-container *ngTemplateOutlet="project_form_template"></ng-container>
  </div>
</div>

<!-- Project form -->
<ng-template #project_form_template>
  <div class="row">
    <h1 [ngClass]="{'placeholder': projectCopy.title.length === 0}">{{showProjectHeading()}}</h1>
    <form class="form-horizontal" #projectForm="ngForm">

      <div class="form-group">
        <label for="title" class="col-sm-2">Title</label>
        <div class="col-sm-10" [ngClass]="{'has-error': isTitleValid(title)}">
          <input class="form-control"
                 id="title"
                 required
                 name="title"
                 [(ngModel)]="projectCopy.title"
                 #title="ngModel">

          <div *ngIf="isTitleValid(title)">
            <span class="help-block" [hidden]="!title.errors.required">Project title must not be empty</span>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="description" class="col-sm-2">Description</label>
        <div class="col-sm-10" [ngClass]="{'has-error': isDescriptionValid(description)}">
          <textarea class="form-control"
                    id="description"
                    name="description"
                    maximumLength="255"
                    [(ngModel)]="projectCopy.description"
                    #description="ngModel"></textarea>

          <div *ngIf="isDescriptionValid(description)">
            <span class="help-block">Description should be under 255 characters</span>
          </div>
        </div>
      </div>

      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
          <button type="submit" class="btn btn-default" (click)="onClickSubmit()" [disabled]="!projectForm.form.valid">
            Submit
          </button>
          &ensp;
          <button type="button" class="btn btn-danger" (click)="onClickCancel()">Cancel</button>
        </div>
      </div>

    </form>
  </div>
</ng-template>

<!-- Normal project view -->
<ng-template #project_view>
  <div *ngIf="project; else no_content">
    <div class="row">
      <h1>
        <span>{{ project.title }}</span>
        <sup *ngIf="project.done"><span class="super label label-info">DONE</span></sup>
      </h1>

      <p class="lead">
        {{ project.description }}
      </p>

      <!-- Timer component -->
      <timer [time]="project.timeInSeconds"
             (onUpdateTime)="updateTime($event)"
             (onLockProject)="lockProject($event)"></timer>
    </div>

    <div class="row">
      <hr>
      <div>
        <p>
          <button type="button" class="btn btn-default" (click)="onClickEdit()">
            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> <span>Edit project</span>
          </button>
          &ensp;
          <button type="button" class="btn btn-danger" (click)="onClickDelete()">
            <span class="glyphicon glyphicon-trash" aria-hidden="true"></span> Delete project
          </button>
        </p>
        <form>
          <input (click)="onClickMarkAsDone($event.target.checked)" type="checkbox" id="project-done" [checked]="project.done"> <label for="project-done">Mark project as done</label>
        </form>
      </div>
    </div>

    <div class="row">
      <checklist (onUpdateProject)="onAddChecklistItem($event)" [project]="project"></checklist>
    </div>
  </div>
</ng-template>

<!-- Shown if no project is selected -->
<ng-template #no_content>
  <div class="row">
    <h1>No project selected</h1>
  </div>
</ng-template>
